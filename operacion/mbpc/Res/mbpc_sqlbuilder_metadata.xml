<?xml version="1.0" encoding="utf-8"?>
<sqlbuilder>
  <entities>
    <entity name="Viaje" id="v">
      <sql description="La entidad viajes relaciona implicitamente a las tabls viajes y buques.">
        tbl_viaje v left join tmp_buques b on v.buque_id = b.id_buque
      </sql>
      <attributes>
        <attribute id="v1" name="Fecha de Llegada" description="Arrivó" type="date" sql_column="v.FECHA_LLEGADA" is_filter="1"/>
        <attribute id="v2" name="Fecha de Salida" description="Partió" type="date" sql_column="v.FECHA_SALIDA" is_filter="1"/>
        <attribute id="v3" name="ETA" description="ETA" type="date" sql_column="v.ETA" is_filter="1"/>
        <attribute id="v4" name="ZOE" description="ZOE" type="date" sql_column="v.ZOE" is_filter="1"/>
        <attribute id="v5" name="Viajando" description="Está viajando" type="hardcoded" data_type="integer" sql_column="v.ESTADO=0" value="0" is_filter="1"/>
        <attribute id="v6" name="Terminado" description="Está terminado" type="hardcoded" data_type="integer" sql_column="v.ESTADO=1" value="1" is_filter="1"/>
        <attribute id="v7" name="Fondeado" description="Está fondeado" type="hardcoded" data_type="integer" sql_column="v.ESTADO=100" value="100" is_filter="1"/>
        
        <attribute id="v8" name="Origen ID" description="Puerto de partida" type="string" sql_column="v.ORIGEN_ID" is_filter="1"/>
        <attribute id="v9" name="Destino ID" description="Puerto de destino" type="string" sql_column="v.DESTINO_ID" is_filter="1"/>
        
        <attribute id="v10" name="Escalas" description="Escalas realizadas" type="integer" sql_column="v.ESCALAS" is_filter="1"/>
        
        <attribute id="v51" name="Número OMI de buque" description="Número OMI" type="string" sql_column="b.NRO_OMI" is_filter="1"/>
        <attribute id="v52" name="Matrícula de buque" description="Matrícula" type="string" sql_column="b.MATRICULA" is_filter="1"/>
        <attribute id="v53" name="Nombre de buque" description="Nombre" type="string" sql_column="b.NOMBRE" is_filter="1"/>
        <attribute id="v54" name="Bandera de buque" description="Bandera" type="string" sql_column="b.BANDERA" is_filter="1"/>
        
      </attributes>
      <relations>
        <relation target="Practico">
          <sql>left join tbl_practicoviaje pv on pv.viaje_id=v.id left join tbl_practico p on p.id=pv.practico_id</sql>
        </relation>
        <relation target="Carga"> 
          <sql>
            left JOIN tbl_etapa e ON e.viaje_id=v.id
            left join tbl_cargaetapa ce ON ce.etapa_id=e.id
            left JOIN tbl_tipo_carga tc ON ce.tipocarga_id=tc.id
            left JOIN tbl_unidad u ON ce.unidad_id=u.id
            left JOIN buques b2 on ce.buque_id=b2.id_buque
          </sql>
        </relation>
      </relations>
    </entity>
    
    <entity name="Practico" id="p">
      <sql>
        tbl_practico p left join tbl_practicoviaje pv on p.id = pv.practico_id
      </sql>
      <attributes>
        <attribute id="p1" name="Nombre" description="Nombre" type="string" sql_column="p.NOMBRE" is_filter="1"/>
        
        <attribute id="p51" name="Horas Trabajadas" description="Trabajó" type="integer" sql_column="pv.TOTAL" is_filter="1"/>
        
        <attribute id="p52" name="Fecha que subió" description="Fecha que subió" type="date" sql_column="pv.FECHA_SUBIDA" is_filter="0"/>
        <attribute id="p53" name="Fecha que bajó" description="Fecha que bajó" type="date" sql_column="pv.FECHA_BAJADA" is_filter="0"/>
        <attribute id="p54" name="Etapa en que subió" description="Etapa en que subió" type="integer" sql_column="pv.ETAPA_SUBIDA" is_filter="0"/>
        <attribute id="p55" name="Etapa en que bajó" description="Etapa en que bajó" type="integer" sql_column="pv.ETAPA_BAJADA" is_filter="0"/>
        <attribute id="p56" name="Activo" description="Activo" type="integer" sql_column="pv.ACTIVO" is_filter="0"/>
        <attribute id="p57" name="Fecha de Activo" description="Fecha de Activo" type="integer" sql_column="pv.FECHA_ACTIVO" is_filter="0"/>
        
      </attributes>
      <relations>
        <relation target="Viaje"> 
          <sql>left join tbl_viaje v on v.id=pv.viaje_id left join tmp_buques b on v.buque_id = b.id_buque</sql>
        </relation>
      </relations>
    </entity>
    
    <entity name="Carga" id="c">
      <sql>
        tbl_cargaetapa ce
        left JOIN tbl_etapa e ON ce.etapa_id=e.id
        left JOIN tbl_tipo_carga tc ON ce.tipocarga_id=tc.id
        left JOIN tbl_unidad u ON ce.unidad_id=u.id
        left JOIN buques b2 on ce.buque_id=b2.id_buque
      </sql>
      <attributes>
        <attribute id="c1" name="Cantidad transportada" description="Cantidad transportada" type="integer" sql_column="ce.CANTIDAD" is_filter="1"/>
        <attribute id="c2" name="Tipo de carga" description="Tipo de carga" type="string" sql_column="tc.CODIGO" is_filter="1"/>
        <attribute id="c3" name="En barcaza" description="En barcaza" type="hardcoded" data_type="integer" sql_column="ce.BUQUE_ID is not null" value="0" is_filter="1"/>
        <attribute id="c4" name="Barcaza" description="Barcaza" type="string" sql_column="b2.NOMBRE" is_filter="1"/>
      </attributes>
      <relations>
        <relation target="Viaje"> 
          <sql>left join tbl_viaje v on v.id=e.viaje_id left join tmp_buques b on v.buque_id = b.id_buque</sql>
        </relation>
      </relations>
    </entity>
  </entities>
  
  <operators>
    <operator type="string" format="">
      <oper id="string_op1" description="Comienza con" format="upper($c) like upper($v%)||'%'" />
      <oper id="string_op2" description="Parecido a" format="upper($c) like '%'||upper($v)||'%'" />
      <oper id="string_op3" description="Es igual a" format="upper($c) = upper($v)" />
      <oper id="string_op4" description="Termina en" format="upper($c) like '%'||upper($v)" />
    </operator>
    <operator type="integer" format="0.#">
      <oper id="numeric_op1" description="Es igual a" format="$c = $v" />
      <oper id="numeric_op2" description="Es mayor que" format="$c &lt; $v" />
      <oper id="numeric_op3" description="Es menor que" format="$c &gt; $v" />
    </operator>
    <operator type="date" format="{0:dd-MM-yy}">
      <oper id="date_op1" description="El dia" format="$c = $v" />
      <oper id="date_op2" description="Despues de" format="$c &gt; $v" />
      <oper id="date_op3" description="Antes de" format="$c &lt; $v" />
    </operator>
  </operators>
</sqlbuilder>